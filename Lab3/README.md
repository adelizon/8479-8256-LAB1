# 3η Εργαστηριακή Άσκηση 

## Μέρος 1ο

### Ερώτημα 1


Ο McPat αποτελεί έναν εξομοιωτή που μπορεί να μοντελοποιήσει αρχιτεκτονικές επεξεργαστών και να παράσχει εκτιμήσεις για τη κατανάλωση ισχύος τους.

Ας δούμε αρχικά, πως ορίζεται η κατανάλωση ισχύος σε έναν επεξεργαστή.

Οι πιο σημαντικοί παράγοντες που συμβάλλουν στη κατανάλωση ισχύος σε έναν επεξεργαστή έιναι η _**δυναμική κατανάλωση ισχύος**_, η _**κατανάλωση ισχύος βραχυκύκλωσης**_, καθώς και κατανάλωση που οφείλεται στα _**ρεύματα διαρροής**_ των τρανζίστορ. Μπορούμε να εκφράσουμε την κατανάλωση ενός επεξεργαστή ως:
_**Pcpu = Pdyn + Psc + Pleak**_

#### **Δυναμική κατανάλωση ισχύος (dynamic power loss):**
Η δυναμική κατανάλωση ισχύος προέρχεται από τη λειτουργία των λογικών πυλών μέσα στον επεξεργαστή. Πρακτικά, αναφέρεται στη κατανάλωση του επεξεργαστεί κατά την εκτέλεση μια λειτουργίας. Όπως γνωρίσουμε, οι λογικές πύλες μέσα σε έναν επεξεργαστή υλοποιούνται με τρανζίστορ, και εκφράζονται ως μια χωρητικότητα. Αυτό σημαίνει πως όταν η κατάσταση σε μια λογική πύλη αλλάζει (από 0 σε 1 ή από 1 σε 0), αυτό που συμβαίνει στην ουσία είναι ροή ενέργειας καθώς φορτίζεται ή εκφορτίζεται ένας πυκνωτής. Η δυναμική κατανάλωση ισχύος είναι κατά προσέγγιση ανάλογη με τη συχνότητα λειτουργίας του επεξεργαστή και με το τετράγωνο της τάσης τροφοδοσίας του και μπορεί να αποτυπωθεί με το τύπο:
**Pcpu = C(V^2)f**.

#### **Κατανάλωση ισχύος βραχυκύκλωσης:**
Όπως αναφέραμε παραπάνω, οι λογικές πύλες των επεξεργαστών αποτελούνται από τρανζίστορ. Αυτό σημαίνει πως η κατάσταση των τρανζίστορ αλλάζει κατά τη λειτουργία της πύλης. Καθώς ο χρόνος που απαιτείται για τη αλλαγή της κατάστασης ενός τρανζίστορ είναι πεπερασμένος, υπάρχει περίπτωση μερικές φορές να άγουν τρανζίστορ από τη τροφοδοσία προς τη γη ταυτόχρονα, δημιουργώντας για πολύ μικρό χρονικό διάστημα ένα βραχυκύκλωμα. Παρόλα αυτά η απώλειες αυτές είναι πολυ δύσκολο να μοντελοποιηθούν σε μακροσκοπική ανάλυση.

#### **Κατανάλωση λόγω ρευμάτων διαρροής (leakage - στατική κατανάλωση):**
Γίνεται εύκολα κατανοητό πως αυτή η κατανάλωση ωφείλεται στα ρεύματα διαρροής των τρανζίστορ. Υπάρχουν δύο κατηγορίες ρευμάτων. Η πρώτη είναι το ρεύμα διαρροής υποστρώματος, το οποίο είναι ρεύμα μεταξύ πηγής και εκπομπού του τρανζίστορ όταν η Vgs είναι μικρότερη από το threshold, καθώς και το ρεύμα διαρροής της πύλης το οποίο είναι αρκετά μικρότερο απ το πρώτο. (Αναφέρονται στα αποτελέσματα του McPAT ως **Subthreshold Leakage** και **Gate Leakage** αντίστοιχα). Τα ρεύματα αυτά σχετίζονται με τις διαστάσεις των τρανζίστορ, τις φυσικές τους ιδιότητες, τη τάση τροφοδοσίας και ενίοτε τη θερμοκρασία.

Υπάρχουν αρκετές τεχνικές για τη μείωση της κατανάλωσης ισχύος σε έναν επεξεργαστή και τα τελευταία χρόνια με την αύξηση των απαιτήσεων σε υπολογιστική ισχύ, η μειωμένη κατανάλωση είναι ακόμα πιο σημαντική και από την αύξηση των επιδόσεων. 
Μια από αυτές τις τεχνικές είναι και το **Power Gating** (αναφέρεται στην έξοδο του McPAT ως **subthreshold leakage with power gating**), κατά το οποίο διακόπτεται η τροφοδοσία σε μπλοκ τρανζίστορ τα οποία δε χρειάζονται εκείνη τη χρονική στιγμή, μειώνοντας έτσι το συνολικό ρεύμα διαρροής του επεξεργαστή. (Στην προσομοίωση του Xeon, παρατηρούμε πως η κατανάλωση λόγω διαρροής είναι λιγότερο από τη μισή με τη τεχνική του power gating.)


Εφόσον η δυναμική κατανάλωση ισχύος ωφείλεται στην λειτουργία του επεξεργασή ενώ η στατική κατανάλωση υπάρχει στην απουσία λειτουργίας, μπορούμε να καταλάβουμε πως διαφορετικά προγράμματα θα έχουν επίπτωση στη δυναμική κατανάλωση. Για παράδειγμα ένα απαιτητικό πρόγραμμα που απαιτεί πολλαπλές αριθμητικές πράξεις, προσπελάσεις της κύριας μνήμης κ.τ.λ., έχει ως αποτέλεσμα πολλές εναλλαγές στις καταστάσεις των λογικών πυλών και συνεπώς αύξηση κατανάλωσης. 
Όταν μιλάμε για τον ίδιο επεξεργαστή, μεγαλύτερη χρονική διάρκεια εκτέλεσης σημαίνει απαιτητικότερο πρόγραμμα γεγονός που θα οδηγήσει σε αυξημένη κατανάλωση. Ωστόσο αν μιλάμε για δύο διαφορετικούς επεξεργαστές, ο μεγαλύτερος χρόνος εκτέλεσης μπορεί να έγκειται σε χαμηλότερη συχνότητα λειτουργίας όπου οδηγεί σε χαμηλότερη κατανάλωση όπως αναφέρθηκε παραπάνω. Γι αυτό και η επιλογή συχνότητας λειτουργίας θα πρέπει να επιλέγεται ανάλογα με τις απαιτήσεις. (υπάρχουν ακόμα και τεχνικές όπως το Dynamic frequency scaling, κατά το οποίο η συχνότητα λειτουργίας προσαρμόζεται δυναμικά ανάλογα με τις ανάγκες.) Παράλληλα μεγαλύτερος χρόνος εκτέλεσης μπορεί αν σημαίνει μεγαλύτερα διαστήματα ηρεμίας σε blocks, που σημαίνει με τη σειρά του μεγαλύτερη στατική κατανάλωση.)


### Ερώτημα 2


Όπως είδαμε και στα δύο προηγούμενα εργαστήρια, η αύξηση της συχνότητας λειτουργίας ενός επεξεργαστή μειώνει τους χρόνους εκτέλεσης και αυξάνει τη ταχύτητα του. Παρόλα αυτά όπως αναφέραμε, η ραγδαία αύξηση των απαιτήσεων σε υπολογιστική ισχύ, έχει καταστήσει απαραίτητη την αύξηση της ενεργειακής αποδοτικότητας των επεξεργαστών. 
Όπως γνωρίζουμε, η ενεργειακή αποδοτικότητα είναι η εκμεταλλευόμενη ενέργεια προς την αρχική ενέργεια εισόδου. 
Για το πεδίο των επεξεργαστών, ορίζουμε την ενεργειακή αποδοτικότητα (energy efficiency) ως το βαθμό των υπολογισμών που μπορούν να πραγματοποιηθούν ανα 1 watt ισχύος που καταναλώνεται. Συνήθως εκφράζεται σε FLOPS/Watt. (Floating Point Operations Per Second)
Αντιλαμβανόμαστε λοιπόν, πως είναι πιθανό ένας επεξεργαστής που καταναλώνει 40 Watt εφόσον έχει καλύτερο energy efficiency (πρακτικά πραγματοποιεί τα tasks του σε πολύ λιγότερο χρόνο) από έναν επεξεργαστή που καταναλώνει 5Watt, να δίνει στο σύστημα μεγαλύτερη διάρκεια μπαταρίας καθώς θα λειτουργεί πιθανώς για πολύ λιγότερη ώρα. Από τον McPAT όμως δεν μπορούμε να πάρουμε μια τέτοια πληροφορία, καθώς θα πρέπει να συνδυαστεί με έναν προσομοιωτή σαν τον gem5 ώστε να χρησιμοποιήσει αποτελέσματα από τη λειτουργία του επεξεργαστή (CPI, SIMULATION TIME κτλ).


### Eρώτημα 3

Τρέχοντας 







## Πηγές

[McPAT](https://pdfs.semanticscholar.org/dbb3/f7142c95631a347222950099aeb4661f8d5c.pdf?fbclid=IwAR3ra8oeZJ46_E6HUCDkk7vNYZrzGy9aVnv1tnkmFw82OfZj38gdqWjCW7o)

[CPU Power Dissipation](https://en.wikipedia.org/wiki/CPU_power_dissipation)

[Power Gating](https://en.wikipedia.org/wiki/Power_gating)

[Leakage](https://en.wikipedia.org/wiki/Leakage_(electronics))

[Static Power](https://www.sciencedirect.com/topics/computer-science/static-power)

[Dynamic frequency scaling](https://en.wikipedia.org/wiki/Dynamic_frequency_scaling)

(https://www.sciencedirect.com/topics/computer-science/dynamic-power-consumption)
